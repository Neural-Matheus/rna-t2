ADR-003 — Estratégia de Reranking

Contexto

O retrieval baseado apenas em bi-encoders é rápido, mas pode retornar trechos semanticamente próximos porém pouco relevantes. Já o cross-encoder oferece precisão muito maior, mas é caro computacionalmente. Para equilibrar velocidade e qualidade, é necessário combinar as duas abordagens.

Decisão

Implementar um pipeline de 2 estágios:

Retrieval inicial com bi-encoder → retorna um conjunto maior de candidatos.

Reranking com cross-encoder → reordena e seleciona apenas os trechos realmente mais relevantes.

Configuração

Retrieval (bi-encoder): top-20 documentos.

Reranking (cross-encoder): seleção dos top-3 finais.

Modelo cross-encoder: ms-marco-MiniLM-L-6-v2.

Razões

Combina alta velocidade no primeiro estágio com alta precisão no segundo.

Aumenta recall inicial e melhora a qualidade final da recuperação.

Mantém o custo computacional baixo o suficiente para rodar no Google Colab.

Alternativas Rejeitadas

Somente retrieval: rápido, porém com queda significativa na precisão final do RAG.

Somente reranking: muito lento, pois exigiria comparar o cross-encoder com todo o conjunto de chunks.

Consequências

Melhora consistente de precisão nas respostas do RAG.

Aumento mínimo de tempo de execução, mantendo boa usabilidade.